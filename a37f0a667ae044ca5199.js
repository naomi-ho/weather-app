import"../style.css";import{displayCurrent,displayToday,displayForecast}from"./dom";import{processJson}from"./api";const form=document.getElementById("locationForm"),locationInput=document.getElementById("location"),contentContainer=document.getElementById("content"),toggle=document.getElementById("toggle"),errorDisplay=document.createElement("div");let currentUnit="us",currentLocation="New York";async function loadWeatherData(t,e){try{const n=await processJson(t,e);errorDisplay.style.display="none",contentContainer.innerHTML="",displayCurrent(n,e),displayToday(n,e),displayForecast(n,e)}catch(e){contentContainer.innerHTML=`<div class="error-state">\n      <p>Unable to display weather for ${t}</p>\n    </div>`}}loadWeatherData(currentLocation,currentUnit),form.addEventListener("submit",(async t=>{t.preventDefault();const e=locationInput.value.trim();if(e){currentLocation=e;try{await loadWeatherData(currentLocation,currentUnit),locationInput.value=""}catch{showError("Failed to fetch weather data")}}else showError("Please enter a location")})),toggle.addEventListener("change",(async()=>{if(currentUnit=toggle.checked?"metric":"us",currentLocation)try{await loadWeatherData(currentLocation,currentUnit)}catch{showError("Failed to update units")}else showError("Please search for a location first")}));